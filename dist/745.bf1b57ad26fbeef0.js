"use strict";(self.webpackChunkcodepulse=self.webpackChunkcodepulse||[]).push([[745],{1745:(L,f,r)=>{r.r(f),r.d(f,{BlogPostModule:()=>w});var d=r(6814),c=r(8145),m=r(1333),e=r(5879),p=r(8101),u=r(6080);const x=function(i){return["/admin/blogposts",i]};function C(i,g){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e._UZ(5,"td")(6,"td"),e.TgZ(7,"td")(8,"div",7)(9,"a",8),e._uU(10,"Edit"),e.qZA(),e.TgZ(11,"a",9),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.onDelete(s.payload.doc.id))}),e._uU(12,"Delete"),e.qZA()()()()}if(2&i){const t=g.$implicit;e.xp6(2),e.Oqu(t.payload.doc.data().title),e.xp6(2),e.Oqu(t.payload.doc.data().desc),e.xp6(5),e.Q6J("routerLink",e.VKq(3,x,t.payload.doc.id))}}function S(i,g){if(1&i&&(e.ynx(0),e.TgZ(1,"table",5)(2,"thead")(3,"tr")(4,"th"),e._uU(5,"Title"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Short Description"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Is Visible?"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Categories"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Actions"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,C,13,5,"tr",6),e.ALo(16,"async"),e.qZA()(),e.BQk()),2&i){const t=e.oxw();e.xp6(15),e.Q6J("ngForOf",e.lcZ(16,1,t.blogsFromFirebase))}}const T=function(){return["/admin/blogposts/add"]};let A=(()=>{class i{constructor(t,o){this.blogPostServ=t,this.spinServ=o}onDelete(t){console.log("id",t),t&&(this.spinServ.requestStarted(),this.blogPostServ.deletePostFromFirebase(t).then(()=>{console.log("Post deleted successfully!"),this.blogPostServ.getAllBlogPostsFromFirebase().then(o=>{this.blogsFromFirebase=o,this.spinServ.requestEnded()}).catch(o=>{this.spinServ.requestEnded()})}).catch(o=>{console.error("Error deleting post: ",o),this.spinServ.requestEnded()}))}ngOnInit(){this.blogPostServ.getAllBlogPostsFromFirebase().then(t=>{this.blogsFromFirebase=t,this.spinServ.requestEnded()}).catch(t=>{this.spinServ.requestEnded()})}ngOnDestroy(){this.deleteBlogPostSubscription?.unsubscribe()}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(p.u),e.Y36(u.V))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-blogpost-list"]],decls:7,vars:3,consts:[[1,"container"],[1,"mt-3"],[1,"d-flex","justify-content-end","mt-3"],[1,"btn","btn-primary",3,"routerLink"],[4,"ngIf"],[1,"table","table-bordered","mt-3","table-responsive"],[4,"ngFor","ngForOf"],[1,"d-flex","m-1"],[1,"btn","btn-light","m-1",3,"routerLink"],[1,"btn","btn-danger","m-1",3,"click"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"BlogPost List"),e.qZA(),e.TgZ(3,"div",2)(4,"a",3),e._uU(5,"Add BlogPost"),e.qZA()(),e.YNc(6,S,17,3,"ng-container",4),e.qZA()),2&o&&(e.xp6(4),e.Q6J("routerLink",e.DdM(2,T)),e.xp6(2),e.Q6J("ngIf",n.blogsFromFirebase))},dependencies:[c.rH,d.sg,d.O5,d.Ov]})}return i})();var b=r(900),M=r(5619),v=r(553),y=r(9862);let Z=(()=>{class i{constructor(t){this.http=t,this.selectedImage=new M.X({id:"",fileExtension:"",fileName:"",title:"",url:""})}getAllImages(){return this.http.get(`${v.N.apiBaseUrl}/api/images`)}uploadImage(t,o,n){const s=new FormData;return s.append("file",t),s.append("fileName",o),s.append("title",n),this.http.post(`${v.N.apiBaseUrl}/api/Images`,s)}selectImage(t){this.selectedImage.next(t)}onSelectImage(){return this.selectedImage.asObservable()}static#e=this.\u0275fac=function(o){return new(o||i)(e.LFG(y.eN))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var B=r(5257),l=r(6223),h=r(4611);function F(i,g){if(1&i&&e._UZ(0,"img",25),2&i){const t=e.oxw();e.Q6J("src",t.imageFileUrl,e.LSH)}}function U(i,g){if(1&i&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&i){const t=g.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function q(i,g){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"select",26),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.model.categories=n)}),e.YNc(2,U,2,2,"option",27),e.qZA(),e.BQk()}if(2&i){const t=g.ngIf,o=e.oxw();e.xp6(1),e.Q6J("ngModel",o.model.categories),e.xp6(1),e.Q6J("ngForOf",t)}}function I(i,g){if(1&i&&e._UZ(0,"img",30),2&i){const t=e.oxw(2);e.Q6J("src",t.imageFileUrl,e.LSH)}}function D(i,g){if(1&i&&e._UZ(0,"img",30),2&i){const t=e.oxw(2);e.Q6J("src",t.model.imageUrl,e.LSH)}}function E(i,g){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"form",3,4),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onFormSubmit())}),e.TgZ(3,"div",5)(4,"div",1)(5,"label",6),e._uU(6,"Title"),e.qZA(),e.TgZ(7,"input",7),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.model.title=n)}),e.qZA()(),e.TgZ(8,"div",1)(9,"label",8),e._uU(10,"Short Description"),e.qZA(),e.TgZ(11,"input",9),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.model.desc=n)}),e.qZA()(),e.TgZ(12,"div",1)(13,"label",10),e._uU(14,"Content"),e.qZA(),e.TgZ(15,"div",11)(16,"div",12)(17,"textarea",13),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.model.content=n)}),e.qZA()(),e.TgZ(18,"div",14),e._UZ(19,"markdown",15),e.qZA()()(),e.TgZ(20,"div",1)(21,"label",16),e._uU(22,"Featured Image Url "),e.TgZ(23,"input",17),e.NdJ("change",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.uploadImage(n))}),e.qZA(),e.YNc(24,I,1,1,"img",18),e.YNc(25,D,1,1,"img",18),e.qZA()(),e.TgZ(26,"div",1)(27,"label",19),e._uU(28,"Published Date"),e.qZA(),e.TgZ(29,"input",20),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.model.publishedDate=n)}),e.ALo(30,"date"),e.qZA()(),e.TgZ(31,"div",1)(32,"label",21),e._uU(33,"createdBy"),e.qZA(),e.TgZ(34,"input",22),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.model.createdBy=n)}),e.qZA()(),e.TgZ(35,"div",23)(36,"input",24),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.model.isVisible=n)}),e.qZA(),e.TgZ(37,"label",25),e._uU(38," Is Visible? "),e.qZA()(),e.TgZ(39,"div",1)(40,"label",26),e._uU(41,"Categories"),e.qZA()(),e.TgZ(42,"div",27)(43,"button",28),e._uU(44,"Save"),e.qZA(),e.TgZ(45,"button",29),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onDelete())}),e._uU(46,"Delete"),e.qZA()()()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(7),e.Q6J("ngModel",t.model.title),e.xp6(4),e.Q6J("ngModel",t.model.desc),e.xp6(6),e.Q6J("ngModel",t.model.content),e.xp6(2),e.Q6J("data",t.model.content),e.xp6(5),e.Q6J("ngIf",t.imageFileUrl),e.xp6(1),e.Q6J("ngIf",t.model.imageUrl),e.xp6(4),e.s9C("value",t.model.publishedDate),e.Q6J("ngModel",e.xi3(30,10,t.model.publishedDate,"yyy-MM-dd")),e.xp6(5),e.Q6J("ngModel",t.model.createdBy),e.xp6(2),e.Q6J("ngModel",t.model.isVisible)}}const N=[{path:"",component:A,canActivate:[m.p]},{path:"add",component:(()=>{class i{constructor(t,o,n,s,a,_){this.blogpostServ=t,this.router=o,this.categorySer=n,this.imageServ=s,this.authServ=a,this.spinServ=_,this.isImageSelectorVisible=!1,this.model={title:"",desc:"",imageUrl:"",content:"",author:"",isVisible:!0,publishedDate:new Date,lastEditedDate:new Date,categories:[],createdBy:"",createdById:""}}ngOnInit(){this.user=this.authServ.getUser()}onFormSubmit(){this.user&&(console.log(this.model),this.model.createdBy=this.user?.name,this.model.createdById=this.user?.uid,this.spinServ.requestStarted(),this.blogpostServ.createPostToFirebase(this.model,this.imageFileEventData).then(()=>{this.spinServ.requestEnded(),this.router.navigate(["/"])}).catch(t=>{this.spinServ.requestEnded(),console.error("Error retrieving post: ",t)}))}uploadImage(t){this.imageFileEventData=t;const o=t.target.files[0];if(o){const n=new FileReader;n.readAsDataURL(o),n.onload=()=>{this.imageFileUrl=n.result}}}ngOnDestroy(){this.imageSelectorSubscription?.unsubscribe()}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(p.u),e.Y36(c.F0),e.Y36(b.H),e.Y36(Z),e.Y36(B.e),e.Y36(u.V))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-blogpost"]],decls:45,vars:14,consts:[[1,"container"],[1,"mt-3"],[3,"ngSubmit"],["form","ngForm"],[1,"mt-2","mb-5"],["for","title",1,"form-label"],["type","text","id","title","name","title",1,"form-control",3,"ngModel","ngModelChange"],["for","desc",1,"form-label"],["type","text","id","desc","name","desc",1,"form-control",3,"ngModel","ngModelChange"],["for","content",1,"form-label"],[1,"d-flex","flex-row"],[1,"col-6","p-2"],["name","content","id","content",1,"form-control",2,"height","350px","max-height","350px",3,"ngModel","ngModelChange"],[1,"col-6","p-2",2,"max-height","350px","overflow-y","scroll"],[3,"data"],["for","imageFileUrl",1,"form-label"],["type","file","accept","image/*",3,"change"],["class","img-fluid","alt","Selected Image",3,"src",4,"ngIf"],["for","publishedDate",1,"form-label"],["type","date","id","publishedDate","name","publishedDate",1,"form-control",3,"value","ngModel","ngModelChange"],["for","author",1,"form-label"],[1,"d-none","d-xl-inline-block","ms-1","fw-medium","font-size-15"],["for","categories",1,"form-label"],[4,"ngIf"],["type","submit",1,"btn","btn-primary"],["alt","Selected Image",1,"img-fluid",3,"src"],["name","categories","id","categories","multiple","",1,"form-control",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Add BlogPost"),e.qZA(),e.TgZ(3,"form",2,3),e.NdJ("ngSubmit",function(){return n.onFormSubmit()}),e.TgZ(5,"div",4)(6,"div",1)(7,"label",5),e._uU(8,"Title"),e.qZA(),e.TgZ(9,"input",6),e.NdJ("ngModelChange",function(a){return n.model.title=a}),e.qZA()(),e.TgZ(10,"div",1)(11,"label",7),e._uU(12,"Short Description"),e.qZA(),e.TgZ(13,"input",8),e.NdJ("ngModelChange",function(a){return n.model.desc=a}),e.qZA()(),e.TgZ(14,"div",1)(15,"label",9),e._uU(16,"Content"),e.qZA(),e.TgZ(17,"div",10)(18,"div",11)(19,"textarea",12),e.NdJ("ngModelChange",function(a){return n.model.content=a}),e.qZA()(),e.TgZ(20,"div",13),e._UZ(21,"markdown",14),e.qZA()()(),e.TgZ(22,"div",1)(23,"label",15),e._uU(24,"Featured Image Url "),e.TgZ(25,"input",16),e.NdJ("change",function(a){return n.uploadImage(a)}),e.qZA(),e.YNc(26,F,1,1,"img",17),e.qZA()(),e.TgZ(27,"div",1)(28,"label",18),e._uU(29,"Published Date"),e.qZA(),e.TgZ(30,"input",19),e.NdJ("ngModelChange",function(a){return n.model.publishedDate=a}),e.ALo(31,"date"),e.qZA()(),e.TgZ(32,"div",1)(33,"label",20),e._uU(34,"Author : "),e.qZA(),e.TgZ(35,"span",21),e._uU(36),e.qZA()(),e.TgZ(37,"div",1)(38,"label",22),e._uU(39,"Categories"),e.qZA(),e.YNc(40,q,3,2,"ng-container",23),e.ALo(41,"async"),e.qZA(),e.TgZ(42,"div",1)(43,"button",24),e._uU(44,"Save"),e.qZA()()()()()),2&o&&(e.xp6(9),e.Q6J("ngModel",n.model.title),e.xp6(4),e.Q6J("ngModel",n.model.desc),e.xp6(6),e.Q6J("ngModel",n.model.content),e.xp6(2),e.Q6J("data",n.model.content),e.xp6(5),e.Q6J("ngIf",n.imageFileUrl),e.xp6(4),e.s9C("value",n.model.publishedDate),e.Q6J("ngModel",e.xi3(31,9,n.model.publishedDate,"yyy-MM-dd")),e.xp6(6),e.Oqu(null==n.user?null:n.user.name),e.xp6(4),e.Q6J("ngIf",e.lcZ(41,12,n.categories$)))},dependencies:[d.sg,d.O5,l._Y,l.YN,l.Kr,l.Fj,l.K7,l.JJ,l.JL,l.On,l.F,h.lF,d.Ov,d.uU]})}return i})(),canActivate:[m.p]},{path:":id",component:(()=>{class i{constructor(t,o,n,s,a,_){this.route=t,this.blogPostServ=o,this.categoryServ=n,this.router=s,this.imageServ=a,this.spinServ=_,this.id=null,this.isImageSelectorVisible=!1}ngOnInit(){this.categories$=this.categoryServ.getAllCategories(),this.route.paramMap.subscribe({next:t=>{this.id=t.get("id"),this.id&&this.blogPostServ.getPostByIdFromFirebase(this.id).then(o=>{o?(console.log("Post data:",o),this.model=o):console.log("Post not found!")}).catch(o=>{console.error("Error retrieving post: ",o)}),this.imageSelectSubscription=this.imageServ.onSelectImage().subscribe({next:o=>{this.model&&(this.model.imageUrl=o.url,this.isImageSelectorVisible=!1)}})}})}onFormSubmit(){this.model&&this.id&&this.blogPostServ.uploadImageToFireStore(this.imageFileEventData,this.id).then(t=>{if(this.spinServ.requestStarted(),this.model){var o={content:this.model.content,desc:this.model.desc,imageUrl:t,isVisible:this.model.isVisible,publishedDate:this.model.publishedDate,title:this.model.title,categories:this.selectedCategories??[],lastEditedDate:new Date,createdBy:this.model.createdBy,createdById:this.model.createdById};console.log("this.id",this.id),this.blogPostServ.updatePostToFirebase(this.id,o).then(()=>{this.router.navigateByUrl("/admin/blogposts"),this.spinServ.requestEnded()}).catch(n=>{this.spinServ.requestEnded(),console.error("Error retrieving post: ",n)})}})}onDelete(){this.id&&(this.spinServ.requestStarted(),this.blogPostServ.deletePostFromFirebase(this.id).then(()=>{this.router.navigateByUrl("/admin/blogposts"),this.spinServ.requestEnded()}).catch(t=>{console.error("Error deleting post: ",t),this.spinServ.requestEnded()}))}openImageSelector(){this.isImageSelectorVisible=!0}closeImageSelector(){this.isImageSelectorVisible=!1}ngOnDestroy(){this.routeSubscription?.unsubscribe(),this.updateBlogPostSubscription?.unsubscribe(),this.getBlogPostSubscription?.unsubscribe(),this.deleteBlogPostSubscription?.unsubscribe(),this.imageSelectSubscription?.unsubscribe()}uploadImage(t){this.imageFileEventData=t;const o=t.target.files[0];if(o){const n=new FileReader;n.readAsDataURL(o),n.onload=()=>{this.imageFileUrl=n.result}}}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(c.gz),e.Y36(p.u),e.Y36(b.H),e.Y36(c.F0),e.Y36(Z),e.Y36(u.V))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit-blogpost"]],decls:4,vars:1,consts:[[1,"container"],[1,"mt-3"],[4,"ngIf"],[3,"ngSubmit"],["form","ngForm"],[1,"mt-2","mb-5"],["for","title",1,"form-label"],["type","text","id","title","name","title",1,"form-control",3,"ngModel","ngModelChange"],["for","desc",1,"form-label"],["type","text","id","desc","name","desc",1,"form-control",3,"ngModel","ngModelChange"],["for","content",1,"form-label"],[1,"d-flex","flex-row"],[1,"col-6","p-2"],["name","content","id","content",1,"form-control",2,"height","350px","max-height","350px",3,"ngModel","ngModelChange"],[1,"col-6","p-2",2,"max-height","350px","overflow-y","scroll"],[3,"data"],["for","featuredImageUrl",1,"form-label"],["type","file","accept","image/*",3,"change"],["class","img-fluid","alt","Selected Image",3,"src",4,"ngIf"],["for","publishedDate",1,"form-label"],["type","date","id","publishedDate","name","publishedDate",1,"form-control",3,"value","ngModel","ngModelChange"],["for","createdBy",1,"form-label"],["type","text","id","createdBy","name","createdBy",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-check","mt-3"],["type","checkbox","id","isVisible","name","isVisible",1,"form-check-input",3,"ngModel","ngModelChange"],["for","isVisible",1,"form-check-label"],["for","categories",1,"form-label"],[1,"mt-3","d-flex"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-danger","ms-3",3,"click"],["alt","Selected Image",1,"img-fluid",3,"src"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Edit BlogPost"),e.qZA(),e.YNc(3,E,47,13,"ng-container",2),e.qZA()),2&o&&(e.xp6(3),e.Q6J("ngIf",n.model))},dependencies:[d.O5,l._Y,l.Fj,l.Wl,l.JJ,l.JL,l.On,l.F,h.lF,d.uU]})}return i})(),canActivate:[m.p]}];let Q=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=e.oAB({type:i});static#o=this.\u0275inj=e.cJS({imports:[c.Bz.forChild(N),c.Bz]})}return i})();var Y=r(7266);let w=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=e.oAB({type:i});static#o=this.\u0275inj=e.cJS({imports:[Q,d.ez,l.u5,l.UX,Y.D,h.JP]})}return i})()}}]);